class Frame{constructor(){this.key="frame",this.name="Frames (Border Patterns)",this.config={num_spiral:{name:"Spirals",value:null,input:{type:"createSlider",params:[2,12,4,1],class:"slider",displayValue:!0}},a:{name:"a",value:null,input:{type:"createSlider",params:[-1,1,.5,.01],class:"slider",displayValue:!0}},b:{name:"b",value:null,input:{type:"createSlider",params:[-1,0,-.35,.01],class:"slider",displayValue:!0}},revolutions:{name:"Revolutions",value:null,input:{type:"createSlider",params:[.1,4,2,.1],class:"slider",displayValue:!0}},rotate:{name:"Rotate",value:null,input:{type:"createSlider",params:[0,360,0,1],class:"slider",displayValue:!0}}},this.path=[]}draw(){this.config.num_spiral.value=parseInt(document.querySelector("#pattern-controls > div:nth-child(1) > input").value),this.config.a.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(2) > input").value),this.config.b.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(3) > input").value),this.config.revolutions.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(4) > input").value),this.config.rotate.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(5) > input").value),document.querySelector("#pattern-controls > div.pattern-control:nth-child(1) > span").innerHTML=this.config.num_spiral.value,document.querySelector("#pattern-controls > div.pattern-control:nth-child(2) > span").innerHTML=this.config.a.value.toFixed(2)+" * r<sub>max</sub>",document.querySelector("#pattern-controls > div.pattern-control:nth-child(3) > span").innerHTML=this.config.b.value.toFixed(2),document.querySelector("#pattern-controls > div.pattern-control:nth-child(4) > span").innerHTML=this.config.revolutions.value.toFixed(1),document.querySelector("#pattern-controls > div.pattern-control:nth-child(5) > span").innerHTML=this.config.rotate.value+"Â°";let path=this.calc(this.config.num_spiral.value,this.config.a.value,this.config.b.value,this.config.revolutions.value,60);return this.config.rotate.value>0&&(path=this.rotationMatrix(path,this.config.rotate.value*(Math.PI/180))),this.path=path,path}calc(num_spirals,a,b,revolutions,sides){var x,y;let radius=Math.min(max_x/2,max_y/2),theta=0;var sides=60;let spiral=this.LogSpiral(a,b,revolutions,60);var translate_x=-spiral[0][0];spiral=this.translate_path(spiral,translate_x,0),spiral=this.rotationMatrix(spiral,-.1*Math.PI),spiral=this.translate_path(spiral,radius,0);for(var master_path=new Array,j=0;j<=60;j++)master_path.push([radius*Math.cos(j/60*2*Math.PI),-radius*Math.sin(j/60*2*Math.PI)]),j%(60/num_spirals)<1&&(master_path=master_path.concat(this.rotationMatrix(spiral,-j/60*2*Math.PI)));return path=master_path,path}translate_path(path,x_delta,y_delta){return path.map((function(a){return[a[0]+x_delta,a[1]+y_delta]}))}rotationMatrix(path,theta){return path.map((function(a){return[a[0]*Math.cos(theta)-a[1]*Math.sin(theta),a[0]*Math.sin(theta)+a[1]*Math.cos(theta)]}))}LogSpiral(a,b,revolutions,sides){var x,y,theta=0,max_r=Math.min(max_x-min_x,max_y-min_y)/2,path=new Array;let theta_max=(revolutions+1/sides)*(2*Math.PI),delta_theta=2*Math.PI/sides;for(var theta=0;theta<theta_max;theta+=delta_theta)x=max_r*a*Math.exp(b*theta)*Math.cos(theta),y=max_r*a*Math.exp(b*theta)*Math.sin(theta),path.push([x,y]);for(var reverse_path=new Array,i=0;i<path.length;i++)reverse_path.push(path[path.length-1-i]);return path=path.concat(reverse_path)}}