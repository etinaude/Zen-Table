class Superellipse{constructor(){this.key="superellipse",this.name="Superellipse";let max_r=Math.min(max_x-min_x,max_y-min_y)/2;this.config={width:{name:"Width",value:null,input:{type:"createSlider",params:[0,.5*(max_x-min_x),max_r,1],class:"slider",displayValue:!0}},height:{name:"Height",value:null,input:{type:"createSlider",params:[0,.5*(max_y-min_y),max_r,1],class:"slider",displayValue:!0}},n:{name:"n-value",value:null,input:{type:"createSlider",params:[.1,10,1.5,.1],class:"slider",displayValue:!0}},spiralize:{name:"Spiralize",value:null,input:{type:"createCheckbox",attributes:[{type:"checkbox",checked:!0}],params:[0,1,1],displayValue:!1}},reverse:{name:"Reverse",value:null,input:{type:"createCheckbox",attributes:[{type:"checkbox",checked:null}],params:[0,1,0],displayValue:!1}}},this.path=[]}draw(){this.config.width.value=parseInt(document.querySelector("#pattern-controls > div:nth-child(1) > input").value),this.config.height.value=parseInt(document.querySelector("#pattern-controls > div:nth-child(2) > input").value),this.config.n.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(3) > input").value),this.config.spiralize.value=!1,document.querySelector("#pattern-controls > div:nth-child(4) > input[type=checkbox]").checked&&(this.config.spiralize.value=!0),document.querySelector("#pattern-controls > div.pattern-control:nth-child(1) > span").innerHTML=this.config.width.value,document.querySelector("#pattern-controls > div.pattern-control:nth-child(2) > span").innerHTML=this.config.height.value,document.querySelector("#pattern-controls > div.pattern-control:nth-child(3) > span").innerHTML=this.config.n.value.toFixed(1);let path=this.calc(this.config.width.value,this.config.height.value,this.config.n.value,this.config.spiralize.value);return this.path=path,path}calc(width,height,n,spiralize){var x,y,a=width,b=height,path=new Array;let sides=60;if(spiralize){a=0,b=0;for(var n_base=n,max_loops=30,loop=0;loop<30;loop++){var a_base=loop/30*width,b_base=loop/30*height;n=loop/30*n_base+.1;for(var theta=0;theta<=2*Math.PI;theta+=2*Math.PI/60)a=a_base+theta/(2*Math.PI)*(width/30),b=b_base+theta/(2*Math.PI)*(height/30),x=Math.pow(Math.abs(Math.cos(theta)),2/n)*a*this.sgn(Math.cos(theta)),y=Math.pow(Math.abs(Math.sin(theta)),2/n)*b*this.sgn(Math.sin(theta)),path.push([x,y])}}else for(var theta=0;theta<=2*Math.PI;theta+=2*Math.PI/60)x=Math.pow(Math.abs(Math.cos(theta)),2/n)*a*this.sgn(Math.cos(theta)),y=Math.pow(Math.abs(Math.sin(theta)),2/n)*b*this.sgn(Math.sin(theta)),path.push([x,y]);return path}sgn(val){return 0==val?0:val/Math.abs(val)}}