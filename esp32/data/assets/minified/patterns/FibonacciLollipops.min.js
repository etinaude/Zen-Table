class FibonacciLollipops{constructor(){this.key="fibonaccilollipops",this.name="Fibonacci Lollipops",this.config={lollipopradius:{name:"Lollipop Radius",value:null,input:{type:"createSlider",params:[10,60,30,1],class:"slider",displayValue:!0}},lollipopsides:{name:"Lollipop Sides",value:null,input:{type:"createSlider",params:[3,12,6,1],class:"slider",displayValue:!0}},lollipopturns:{name:"Lollipop Turns",value:null,input:{type:"createSlider",params:[1.5,7.5,3.5,1],class:"slider",displayValue:!0}},spiral_factor:{name:"Shrink Factor",value:null,input:{type:"createSlider",params:[-.02,-.003,-.01,1e-4],class:"slider",displayValue:!0}}},this.path=[]}draw(){this.config.lollipopradius.value=parseInt(document.querySelector("#pattern-controls > div:nth-child(1) > input").value),this.config.lollipopsides.value=parseInt(document.querySelector("#pattern-controls > div:nth-child(2) > input").value),this.config.lollipopturns.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(3) > input").value),this.config.spiral_factor.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(4) > input").value),document.querySelector("#pattern-controls > div.pattern-control:nth-child(1) > span").innerHTML=this.config.lollipopradius.value,document.querySelector("#pattern-controls > div.pattern-control:nth-child(2) > span").innerHTML=this.config.lollipopsides.value,document.querySelector("#pattern-controls > div.pattern-control:nth-child(3) > span").innerHTML=this.config.lollipopturns.value,document.querySelector("#pattern-controls > div.pattern-control:nth-child(4) > span").innerHTML=this.config.spiral_factor.value.toFixed(4);let path=this.calc(this.config.lollipopradius.value,this.config.lollipopsides.value,this.config.lollipopturns.value,this.config.spiral_factor.value);return this.path=path,path}calc(spiral_r_max,spiral_sides,spiral_revolutions,radius_shrink_factor){for(var path=new Array,r_max=Math.min(max_x-min_x,max_y-min_y)/2,r,theta,x,y,r_min=ball_size/2,i_max=Math.log(r_min/r_max)/radius_shrink_factor,sub_path=new Array,x1,y1,spiral_r,spiral_theta,i=0;i<i_max;i++){theta=i*Math.PI*(3-Math.sqrt(5)),r=(r_max-spiral_r_max)*Math.exp(radius_shrink_factor*i),sub_path=[];for(var k=0;k<=spiral_revolutions*spiral_sides;k++)spiral_theta=k/spiral_sides*(2*Math.PI),x1=(spiral_r=spiral_r_max*(1-i/i_max*.5)*(k/(spiral_revolutions*spiral_sides)))*Math.cos(spiral_theta),y1=spiral_r*Math.sin(spiral_theta),sub_path.push([x1,y1]);sub_path=this.translate_path(sub_path,r,0),(path=path.concat(this.rotationMatrix(sub_path,theta))).push([0,0])}return path}translate_path(path,x_delta,y_delta){return path.map((function(a){return[a[0]+x_delta,a[1]+y_delta]}))}rotationMatrix(path,theta){return path.map((function(a){return[a[0]*Math.cos(theta)-a[1]*Math.sin(theta),a[0]*Math.sin(theta)+a[1]*Math.cos(theta)]}))}}