class ZigZag{constructor(){this.key="zigzag",this.name="Zig Zag",this.config={bound:{name:"Bounding Shape",value:null,input:{type:"createSelect",options:{rectangle:"Max Rectangle",circle:"Max Circle"}}},spacing:{name:"Spacing",value:null,input:{type:"createSlider",params:[-(max_y-min_y)/2,-1,(max_y-min_y)/2*-.5,1],class:"slider",displayValue:!0}},margin:{name:"Margin",value:null,input:{type:"createSlider",params:[0,Math.min(max_x-min_x,max_y-min_y)/10,0,1],class:"slider",displayValue:!0}},rotation:{name:"Rotation",value:null,input:{type:"createSlider",params:[-180,180,0,1],class:"slider",displayValue:!0}},border:{name:"Border",value:null,input:{type:"createCheckbox",attributes:[{type:"checkbox",checked:!0}],params:[0,1,0],displayValue:!1}},reverse:{name:"Reverse",value:null,input:{type:"createCheckbox",attributes:[{type:"checkbox",checked:null}],params:[0,1,0],displayValue:!1}}},this.path=[]}draw(){this.config.bound.value=document.querySelector("#pattern-controls > div:nth-child(1) > select").value,this.config.spacing.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(2) > input").value),this.config.margin.value=parseInt(document.querySelector("#pattern-controls > div:nth-child(3) > input").value),this.config.rotation.value=parseFloat(document.querySelector("#pattern-controls > div:nth-child(4) > input").value),this.config.border.value=0,document.querySelector("#pattern-controls > div:nth-child(5) > input[type=checkbox]").checked&&(this.config.border.value=1),document.querySelector("#pattern-controls > div.pattern-control:nth-child(2) > span").innerHTML=nfc((max_y-min_y)/-this.config.spacing.value,1)+" "+units,document.querySelector("#pattern-controls > div.pattern-control:nth-child(3) > span").innerHTML=this.config.margin.value+" mm",document.querySelector("#pattern-controls > div.pattern-control:nth-child(4) > span").innerHTML=this.config.rotation.value+"Â°";let path=this.calc((max_y-min_y)/-this.config.spacing.value,this.config.margin.value,0,this.config.border.value,this.config.bound.value);return path=path.map((function(element){return this.rotationMatrix(element[0],element[1],this.config.rotation.value*(Math.PI/180))}),this),this.path=path,path}calc(spacing,margin,angle,border,bounding_shape){for(var start_x=-(max_x/2-margin),start_y=-(max_y/2-margin),x=start_x,y=start_y,path=new Array,step=0;y+spacing<=max_y/2-margin;)"circle"==bounding_shape?step%4==0?x=Math.sqrt(Math.pow(190,2)-Math.pow(y,2)):step%4==1?(y+=spacing,x=Math.sqrt(Math.pow(190,2)-Math.pow(y,2))):step%4==2?x=-Math.sqrt(Math.pow(190,2)-Math.pow(y,2)):step%4==3&&(y+=spacing,x=-Math.sqrt(Math.pow(190,2)-Math.pow(y,2))):step%4==0?x=(max_x-min_x)/2-margin:step%4==2?x=-(max_x-min_x)/2+margin:y+=spacing,path.push([x,y]),step++;if(border)if("circle"==bounding_shape)for(var theta=0;theta<2*Math.PI;theta+=2*Math.PI/60)path.push([.5*(max_y-min_y)*Math.cos(theta+.5*Math.PI),.5*(max_y-min_y)*Math.sin(theta+.5*Math.PI)]);else x<0?(path.push([max_x/2-margin,y]),path.push([max_x/2-margin,start_y]),path.push([x,start_y]),path.push([x,y])):(path.push([+((max_x-min_x)/2-margin),start_y]),path.push([-((max_x-min_x)/2-margin),start_y]),path.push([-((max_x-min_x)/2-margin),y]),path.push([x,y]));return path}rotationMatrix(x,y,theta){return[x*Math.cos(theta)-y*Math.sin(theta),x*Math.sin(theta)+y*Math.cos(theta)]}}